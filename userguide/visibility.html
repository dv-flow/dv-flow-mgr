<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Task Visibility &#8212; DV Flow Manager  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Developing Tasks" href="tasks_developing.html" />
    <link rel="prev" title="Dataflow &amp; Produces" href="dataflow.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="task-visibility">
<h1>Task Visibility<a class="headerlink" href="#task-visibility" title="Link to this heading">¶</a></h1>
<p>Task visibility controls which tasks are exposed as entry points, which are
accessible across package boundaries, and which are internal implementation
details. The visibility system helps package authors create clean APIs while
hiding internal complexity.</p>
<section id="visibility-scopes">
<h2>Visibility Scopes<a class="headerlink" href="#visibility-scopes" title="Link to this heading">¶</a></h2>
<p>DV Flow Manager supports three visibility scopes that can be assigned to tasks:</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Visibility Scopes</span><a class="headerlink" href="#id1" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 15.0%" />
<col style="width: 85.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Scope</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">root</span></code></p></td>
<td><p>Task is an executable entry point. Shown in task listing when running <code class="docutils literal notranslate"><span class="pre">dfm</span> <span class="pre">run</span></code> without arguments.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">export</span></code></p></td>
<td><p>Task is visible outside the package. Other packages can reference this task in their <code class="docutils literal notranslate"><span class="pre">needs</span></code> lists.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">local</span></code></p></td>
<td><p>Task is only visible within its declaration fragment (e.g., within a task body or fragment file).</p></td>
</tr>
</tbody>
</table>
<p>Tasks without any scope specifier have <strong>package visibility</strong> - they can be
referenced by other tasks in the same package but are not shown as entry points
and will generate a warning if referenced from other packages.</p>
</section>
<section id="specifying-scope">
<h2>Specifying Scope<a class="headerlink" href="#specifying-scope" title="Link to this heading">¶</a></h2>
<p>There are two ways to specify task visibility:</p>
<section id="using-the-scope-field">
<h3>Using the scope Field<a class="headerlink" href="#using-the-scope-field" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">scope</span></code> field can be a single string or a list of scopes:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>
<span class="c1"># Single scope</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
<span class="w">  </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root</span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">make build</span>

<span class="c1"># Multiple scopes</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">public_entry</span>
<span class="w">  </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">root</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">export</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Public</span><span class="nv"> </span><span class="s">entry</span><span class="nv"> </span><span class="s">point</span><span class="nv"> </span><span class="s">visible</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">other</span><span class="nv"> </span><span class="s">packages&quot;</span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./run.sh</span>
</pre></div>
</div>
</section>
<section id="using-inline-scope-markers">
<h3>Using Inline Scope Markers<a class="headerlink" href="#using-inline-scope-markers" title="Link to this heading">¶</a></h3>
<p>For convenience, you can use <code class="docutils literal notranslate"><span class="pre">root:</span></code>, <code class="docutils literal notranslate"><span class="pre">export:</span></code>, or <code class="docutils literal notranslate"><span class="pre">local:</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">name:</span></code> to simultaneously name the task and set its scope:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>
<span class="c1"># Equivalent to name: build + scope: root</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">make build</span>

<span class="c1"># Equivalent to name: format + scope: export</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">export</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">format</span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">format.sh</span>

<span class="c1"># Equivalent to name: helper + scope: local</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">local</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">helper</span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo &quot;internal&quot;</span>
</pre></div>
</div>
<p>Both inline markers and explicit <code class="docutils literal notranslate"><span class="pre">scope:</span></code> can be combined:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>
<span class="c1"># root inline marker + scope: export = both root and export</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span>
<span class="w">  </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export</span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./main.sh</span>
</pre></div>
</div>
<p>Only one of <code class="docutils literal notranslate"><span class="pre">name:</span></code>, <code class="docutils literal notranslate"><span class="pre">root:</span></code>, <code class="docutils literal notranslate"><span class="pre">export:</span></code>, <code class="docutils literal notranslate"><span class="pre">local:</span></code>, or <code class="docutils literal notranslate"><span class="pre">override:</span></code>
can be specified per task.</p>
</section>
</section>
<section id="root-scope">
<h2>Root Scope<a class="headerlink" href="#root-scope" title="Link to this heading">¶</a></h2>
<p>Tasks marked with <code class="docutils literal notranslate"><span class="pre">scope:</span> <span class="pre">root</span></code> are <strong>executable entry points</strong>. When you run
<code class="docutils literal notranslate"><span class="pre">dfm</span> <span class="pre">run</span></code> without specifying a task, only root tasks are displayed:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">package</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_project</span>

<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
<span class="w">    </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Build</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">project&quot;</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">make build</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test</span>
<span class="w">    </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Run</span><span class="nv"> </span><span class="s">tests&quot;</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">build</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">make test</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">internal_helper</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo &quot;helper&quot;</span>
</pre></div>
</div>
<p>Running <code class="docutils literal notranslate"><span class="pre">dfm</span> <span class="pre">run</span></code> without arguments:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>dfm<span class="w"> </span>run
No<span class="w"> </span>task<span class="w"> </span>specified.<span class="w"> </span>Available<span class="w"> </span>Tasks:
my_project.build<span class="w">  </span>-<span class="w"> </span>Build<span class="w"> </span>the<span class="w"> </span>project
my_project.test<span class="w">   </span>-<span class="w"> </span>Run<span class="w"> </span>tests
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">internal_helper</span></code> is not shown because it lacks <code class="docutils literal notranslate"><span class="pre">scope:</span> <span class="pre">root</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any task can still be run directly by name, regardless of visibility.
Visibility only affects what is <em>listed</em>, not what is <em>runnable</em>.</p>
</div>
</section>
<section id="export-scope">
<h2>Export Scope<a class="headerlink" href="#export-scope" title="Link to this heading">¶</a></h2>
<p>Tasks marked with <code class="docutils literal notranslate"><span class="pre">scope:</span> <span class="pre">export</span></code> are <strong>visible outside the package</strong>. This is
essential for creating reusable packages where other packages depend on your tasks.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># utils/flow.yaml</span>
<span class="nt">package</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">utils</span>

<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">export</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">format</span>
<span class="w">    </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Format</span><span class="nv"> </span><span class="s">source</span><span class="nv"> </span><span class="s">files&quot;</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">format.sh</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check_syntax</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check.sh</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># main/flow.yaml</span>
<span class="nt">package</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span>
<span class="w">  </span><span class="nt">imports</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">utils/flow.yaml</span>

<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">utils.format</span><span class="w">     </span><span class="c1"># OK - format is export</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">utils.check_syntax</span><span class="w">  </span><span class="c1"># WARNING - not marked export</span>
</pre></div>
</div>
<p>When a task references a non-export task from another package, DV Flow Manager
issues a warning:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Warning: Task &#39;main.build&#39; references task &#39;utils.check_syntax&#39;
in package &#39;utils&#39; that is not marked &#39;export&#39;
</pre></div>
</div>
<p>This warning helps identify unintended dependencies on internal implementation
details of other packages.</p>
</section>
<section id="local-scope">
<h2>Local Scope<a class="headerlink" href="#local-scope" title="Link to this heading">¶</a></h2>
<p>Tasks marked with <code class="docutils literal notranslate"><span class="pre">scope:</span> <span class="pre">local</span></code> are only visible within their declaration
context. This is useful for helper tasks in compound task bodies:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">process_files</span>
<span class="w">  </span><span class="nt">body</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">local</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prepare</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./prepare.sh</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">local</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">transform</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">prepare</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./transform.sh</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">finalize</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">transform</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./finalize.sh</span>
</pre></div>
</div>
<p>Local tasks cannot be referenced from outside their containing body or fragment.</p>
</section>
<section id="default-package-visibility">
<h2>Default Package Visibility<a class="headerlink" href="#default-package-visibility" title="Link to this heading">¶</a></h2>
<p>Tasks without any scope specifier have <strong>package visibility</strong>:</p>
<ul class="simple">
<li><p>Can be referenced by other tasks in the same package</p></li>
<li><p>Can be run directly by fully-qualified name</p></li>
<li><p>Are NOT shown in task listings (<code class="docutils literal notranslate"><span class="pre">dfm</span> <span class="pre">run</span></code> without arguments)</p></li>
<li><p>Generate a warning if referenced from other packages</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">package</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_pkg</span>

<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">internal_task</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo &quot;package-visible only&quot;</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">public_entry</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">internal_task</span><span class="p p-Indicator">]</span><span class="w">  </span><span class="c1"># OK - same package</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo &quot;entry point&quot;</span>
</pre></div>
</div>
</section>
<section id="combining-scopes">
<h2>Combining Scopes<a class="headerlink" href="#combining-scopes" title="Link to this heading">¶</a></h2>
<p>Scopes can be combined for tasks that serve multiple purposes:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>
<span class="c1"># Entry point AND visible to other packages</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span>
<span class="w">  </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">root</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">export</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./main.sh</span>

<span class="c1"># Or using inline marker plus scope field</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span>
<span class="w">  </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export</span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./main.sh</span>
</pre></div>
</div>
<p>Common combinations:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[root,</span> <span class="pre">export]</span></code> - Public entry point (both CLI and API)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">root</span></code> alone - Entry point only for this package (not for dependents)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">export</span></code> alone - API for other packages, but not a primary entry point</p></li>
</ul>
</section>
<section id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading">¶</a></h2>
<section id="entry-point-selection">
<h3>Entry Point Selection<a class="headerlink" href="#entry-point-selection" title="Link to this heading">¶</a></h3>
<p>Mark tasks as <code class="docutils literal notranslate"><span class="pre">root</span></code> when they represent meaningful operations a user would
run directly:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>
<span class="c1"># Good: Clear entry points</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
<span class="w">  </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Build</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">project&quot;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test</span>
<span class="w">  </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Run</span><span class="nv"> </span><span class="s">all</span><span class="nv"> </span><span class="s">tests&quot;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">clean</span>
<span class="w">  </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Clean</span><span class="nv"> </span><span class="s">build</span><span class="nv"> </span><span class="s">artifacts&quot;</span>

<span class="c1"># Not root: Implementation details</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compile_rtl</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compile_tb</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">link</span>
</pre></div>
</div>
</section>
<section id="api-design">
<h3>API Design<a class="headerlink" href="#api-design" title="Link to this heading">¶</a></h3>
<p>For reusable packages, carefully consider which tasks to export:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">package</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_library</span>

<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Export: Stable API that users should depend on</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">export</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compile</span>
<span class="w">    </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Compile</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">library</span><span class="nv"> </span><span class="s">settings&quot;</span>

<span class="w">  </span><span class="c1"># Not export: Internal implementation</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gather_sources</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">process_includes</span>

<span class="w">  </span><span class="c1"># Export with root: Both API and entry point</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test</span>
<span class="w">    </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export</span>
<span class="w">    </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Run</span><span class="nv"> </span><span class="s">library</span><span class="nv"> </span><span class="s">self-tests&quot;</span>
</pre></div>
</div>
</section>
<section id="compound-task-organization">
<h3>Compound Task Organization<a class="headerlink" href="#compound-task-organization" title="Link to this heading">¶</a></h3>
<p>Use local scope for helper tasks that should not leak outside:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">full_flow</span>
<span class="w">  </span><span class="nt">rundir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inherit</span>
<span class="w">  </span><span class="nt">body</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Local helpers - not visible outside</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">local</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step1</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./step1.sh</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">local</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step2</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">step1</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./step2.sh</span>

<span class="w">  </span><span class="c1"># Final step produces output</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">result</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">step2</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">std.FileSet</span>
<span class="w">    </span><span class="nt">with</span><span class="p">:</span>
<span class="w">      </span><span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;*.out&quot;</span>
</pre></div>
</div>
</section>
<section id="warning-resolution">
<h3>Warning Resolution<a class="headerlink" href="#warning-resolution" title="Link to this heading">¶</a></h3>
<p>If you see warnings about referencing non-export tasks:</p>
<ol class="arabic simple">
<li><p><strong>If intentional</strong>: Mark the referenced task as <code class="docutils literal notranslate"><span class="pre">export</span></code></p></li>
<li><p><strong>If unintentional</strong>: Refactor to not depend on internal tasks</p></li>
<li><p><strong>If transitional</strong>: Add TODO comment and plan to fix</p></li>
</ol>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Before: Warning about using internal task</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_task</span>
<span class="w">  </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">other_pkg.internal_task</span><span class="p p-Indicator">]</span>

<span class="c1"># After: Either export the task or restructure</span>
<span class="c1"># Option 1: Ask other_pkg maintainer to export it</span>
<span class="c1"># Option 2: Restructure to use exported task</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_task</span>
<span class="w">  </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">other_pkg.public_api</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</section>
</section>
<section id="visibility-in-fragments">
<h2>Visibility in Fragments<a class="headerlink" href="#visibility-in-fragments" title="Link to this heading">¶</a></h2>
<p>Visibility works the same way in package fragments:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># src/rtl/flow.yaml</span>
<span class="nt">fragment</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compile_rtl</span>
<span class="w">    </span><span class="nt">desc</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Compile</span><span class="nv"> </span><span class="s">RTL&quot;</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./compile_rtl.sh</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">helper</span>
<span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./helper.sh</span>
</pre></div>
</div>
<p>All visibility rules apply across the entire package, including all fragments.</p>
</section>
<section id="task-listing-behavior-summary">
<h2>Task Listing Behavior Summary<a class="headerlink" href="#task-listing-behavior-summary" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Scope</p></th>
<th class="head"><p>In Listing</p></th>
<th class="head"><p>Cross-Pkg</p></th>
<th class="head"><p>Direct Run</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>root</p></td>
<td><p>Yes</p></td>
<td><p>Warning</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>export</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>[root, export]</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>local</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>Limited</p></td>
</tr>
<tr class="row-even"><td><p>(none)</p></td>
<td><p>No</p></td>
<td><p>Warning</p></td>
<td><p>Yes</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><strong>In Listing</strong>: Shown by <code class="docutils literal notranslate"><span class="pre">dfm</span> <span class="pre">run</span></code> without arguments</p></li>
<li><p><strong>Cross-Pkg</strong>: Can be referenced in <code class="docutils literal notranslate"><span class="pre">needs</span></code> from another package</p></li>
<li><p><strong>Direct Run</strong>: Can be executed by name</p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">DV Flow Manager</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="fundamentals.html">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="packages.html">Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks_using.html">Using Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataflow.html">Dataflow &amp; Produces</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Task Visibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks_developing.html">Developing Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="incremental.html">Incremental Builds</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Parameters and Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="expressions.html">Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html">Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_features.html">Advanced Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="stdlib.html">Standard Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="llm_integration.html">LLM Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="agent_integration.html">AI Agent Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="native_agent.html">Native AI Agent (dfm agent)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#dataflow">Dataflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Flow-Spec Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/types_api.html">Type System API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cmdref.html">Command reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llms.html">LLM Agent Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pytask_api.html">Python Task API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task_runners.html">Task Runners</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">User Guide</a><ul>
      <li>Previous: <a href="dataflow.html" title="previous chapter">Dataflow &amp; Produces</a></li>
      <li>Next: <a href="tasks_developing.html" title="next chapter">Developing Tasks</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2023-2025, Matthew Ballance.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/userguide/visibility.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>