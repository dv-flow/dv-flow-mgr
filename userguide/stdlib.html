<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Standard Library &#8212; DV Flow Manager  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LLM Integration" href="llm_integration.html" />
    <link rel="prev" title="Advanced Features" href="advanced_features.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="standard-library">
<h1>Standard Library<a class="headerlink" href="#standard-library" title="Link to this heading">¶</a></h1>
<section id="std-createfile">
<h2>std.CreateFile<a class="headerlink" href="#std-createfile" title="Link to this heading">¶</a></h2>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">package</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">create</span>

    <span class="n">tasks</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">TemplateFile</span>
        <span class="n">uses</span><span class="p">:</span> <span class="n">std</span><span class="o">.</span><span class="n">CreateFile</span>
        <span class="k">with</span><span class="p">:</span>
          <span class="nb">type</span><span class="p">:</span> <span class="n">text</span>
          <span class="n">filename</span><span class="p">:</span> <span class="n">template</span><span class="o">.</span><span class="n">txt</span>
          <span class="n">content</span><span class="p">:</span> <span class="o">|</span>
            <span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">template</span> <span class="n">file</span>
            <span class="k">with</span> <span class="n">multiple</span> <span class="n">lines</span>
            <span class="n">of</span> <span class="n">text</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="consumes">
<h3>Consumes<a class="headerlink" href="#consumes" title="Link to this heading">¶</a></h3>
</section>
<section id="produces">
<h3>Produces<a class="headerlink" href="#produces" title="Link to this heading">¶</a></h3>
<p>Produces a <cite>std.FileSet</cite> parameter set containing a single file</p>
</section>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>type</strong> - [Required] Specifies the <cite>filetype</cite> of the produced fileset</p></li>
<li><p><strong>filename</strong> - [Required] Name of the file to produce</p></li>
<li><p><strong>incdir</strong> - [Optional] If ‘true’, adds the output directory as an include directory</p></li>
</ul>
</section>
</section>
<section id="std-fileset">
<h2>std.FileSet<a class="headerlink" href="#std-fileset" title="Link to this heading">¶</a></h2>
<p>Creates a ‘FileSet’ parameter set from a specification. This task is
primarily used to build up list of files for processing by HDL compilation
tools.</p>
<section id="id1">
<h3>Example<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">package</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">fileset</span><span class="o">.</span><span class="n">example</span>

    <span class="n">tasks</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">rtlsrc</span>
        <span class="n">uses</span><span class="p">:</span> <span class="n">std</span><span class="o">.</span><span class="n">FileSet</span>
        <span class="k">with</span><span class="p">:</span>
          <span class="n">include</span><span class="p">:</span> <span class="s1">&#39;*.v&#39;</span>
          <span class="n">base</span><span class="p">:</span> <span class="s1">&#39;src/rtl&#39;</span>
          <span class="nb">type</span><span class="p">:</span> <span class="s1">&#39;verilogSource&#39;</span>
</pre></div>
</div>
<p>The example above finds all files with a <cite>.v</cite> extension in the <cite>src/rtl</cite>
subdirectory of the task’s source directory. The task emits a FileSet
parameter set having the filetype of <cite>verilogSource</cite>.</p>
</section>
<section id="id2">
<h3>Consumes<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>None by default (<code class="docutils literal notranslate"><span class="pre">consumes:</span> <span class="pre">none</span></code>)</p>
</section>
<section id="id3">
<h3>Produces<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>Produces a <cite>std.FileSet</cite> parameter set containing files matched by the parameter specification.</p>
</section>
<section id="id4">
<h3>Parameters<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>type</strong> - [Required] Specifies the <cite>filetype</cite> of the produced fileset</p></li>
<li><p><strong>base</strong> - [Optional] Base directory for the fileset. Defaults to the task’s source directory</p></li>
<li><p><strong>include</strong> - [Required] Set of file patterns to include in the fileset. Glob patterns may be used</p></li>
<li><p><strong>exclude</strong> - [Optional] Set of file patterns to exclude from the fileset. Glob patterns may be used</p></li>
<li><p><strong>incdirs</strong> - [Optional] Set of include directories that consumers of the fileset must use</p></li>
<li><p><strong>defines</strong> - [Optional] Set of pre-processor defines that consumers of the fileset must use</p></li>
<li><p><strong>attributes</strong> - [Optional] Set of attributes to tag the fileset with (e.g., [‘uvm’, ‘testbench’])</p></li>
</ul>
</section>
</section>
<section id="std-exec">
<h2>std.Exec<a class="headerlink" href="#std-exec" title="Link to this heading">¶</a></h2>
<p>Executes a shell command as part of the task flow. This is useful for
running external tools, scripts, or commands that don’t have dedicated
task implementations.</p>
<section id="id5">
<h3>Example<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">package</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exec.example</span>

<span class="w">    </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">run_script</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">std.Exec</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;./scripts/process_data.sh&quot;</span>
<span class="w">        </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<span class="w">        </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">changed</span>
</pre></div>
</div>
</section>
<section id="id6">
<h3>Consumes<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>All inputs by default (<code class="docutils literal notranslate"><span class="pre">consumes:</span> <span class="pre">all</span></code>)</p>
</section>
<section id="id7">
<h3>Produces<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<p>Passes through all inputs to output. Does not produce additional data items.</p>
</section>
<section id="id8">
<h3>Parameters<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>command</strong> - [Required] The shell command to execute</p></li>
<li><p><strong>shell</strong> - [Optional] Shell to use for execution (default: “bash”)</p></li>
<li><p><strong>when</strong> - [Optional] Controls when the command runs:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;always&quot;</span></code> - Always run the command (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;changed&quot;</span></code> - Only run if upstream tasks changed</p></li>
</ul>
</li>
<li><p><strong>timestamp</strong> - [Optional] Path to a timestamp file to check for changes</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">timestamp</span></code> parameter allows incremental execution based on file
timestamps. If specified, the task compares the timestamp of the file
against the previous execution to determine if output changed.</p>
</section>
</section>
<section id="std-setenv">
<h2>std.SetEnv<a class="headerlink" href="#std-setenv" title="Link to this heading">¶</a></h2>
<p>Sets environment variables for use by downstream tasks. Supports glob
pattern expansion for paths, making it easy to configure tool paths
and directories.</p>
<section id="id9">
<h3>Example<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">package</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">setenv.example</span>

<span class="w">    </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tool_env</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">std.SetEnv</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">setenv</span><span class="p">:</span>
<span class="w">          </span><span class="nt">TOOL_HOME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/tools/my_tool</span>
<span class="w">          </span><span class="nt">PYTHONPATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;lib/python/site-packages&quot;</span>
<span class="w">        </span><span class="nt">append_path</span><span class="p">:</span>
<span class="w">          </span><span class="nt">PATH</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/tools/my_tool/bin</span>
<span class="w">        </span><span class="nt">prepend_path</span><span class="p">:</span>
<span class="w">          </span><span class="nt">LD_LIBRARY_PATH</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/tools/my_tool/lib</span>
</pre></div>
</div>
</section>
<section id="glob-expansion">
<h3>Glob Expansion<a class="headerlink" href="#glob-expansion" title="Link to this heading">¶</a></h3>
<p>Values containing glob patterns (<code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">?</span></code>, <code class="docutils literal notranslate"><span class="pre">[...]</span></code>) are expanded
relative to the task’s source directory:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lib_paths</span>
<span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">std.SetEnv</span>
<span class="w">  </span><span class="nt">with</span><span class="p">:</span>
<span class="w">    </span><span class="nt">setenv</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MY_LIBS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;libs/*/lib&quot;</span><span class="w">  </span><span class="c1"># Expands to all lib dirs</span>
</pre></div>
</div>
<p>If multiple paths match, they are joined with the platform path separator
(<cite>:</cite> on Unix, <cite>;</cite> on Windows).</p>
</section>
<section id="id10">
<h3>Consumes<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<p>All inputs by default (<code class="docutils literal notranslate"><span class="pre">consumes:</span> <span class="pre">all</span></code>)</p>
</section>
<section id="id11">
<h3>Produces<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<p>Produces a <code class="docutils literal notranslate"><span class="pre">std.Env</span></code> data item containing the environment variable mappings.</p>
</section>
<section id="id12">
<h3>Parameters<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>setenv</strong> - [Optional] Map of environment variable names to values</p></li>
<li><p><strong>append_path</strong> - [Optional] Map of environment variables to values that should be appended</p></li>
<li><p><strong>prepend_path</strong> - [Optional] Map of environment variables to values that should be prepended</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">append_path</span></code> and <code class="docutils literal notranslate"><span class="pre">prepend_path</span></code> parameters automatically handle
path separator logic for PATH-like environment variables.</p>
</section>
</section>
<section id="std-setfiletype">
<h2>std.SetFileType<a class="headerlink" href="#std-setfiletype" title="Link to this heading">¶</a></h2>
<p>Modifies the file type of input filesets. This is useful when you need
to reinterpret files with a different type for different tools.</p>
<section id="id13">
<h3>Example<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">package</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">setfiletype.example</span>

<span class="w">    </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">verilog_files</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">std.FileSet</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;*.v&quot;</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">verilogSource</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">reinterpret</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">std.SetFileType</span>
<span class="w">      </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">verilog_files</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">filetype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">systemVerilogSource</span>
</pre></div>
</div>
</section>
<section id="id14">
<h3>Consumes<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h3>
<p>Only <code class="docutils literal notranslate"><span class="pre">std.FileSet</span></code> data items (<code class="docutils literal notranslate"><span class="pre">consumes:</span> <span class="pre">[{type:</span> <span class="pre">std.FileSet}]</span></code>)</p>
</section>
<section id="id15">
<h3>Produces<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<p>Produces new <code class="docutils literal notranslate"><span class="pre">std.FileSet</span></code> data items with the updated file type.</p>
</section>
<section id="id16">
<h3>Parameters<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>filetype</strong> - [Required] The new file type to assign to all consumed filesets</p></li>
</ul>
</section>
</section>
<section id="std-incdirs">
<h2>std.IncDirs<a class="headerlink" href="#std-incdirs" title="Link to this heading">¶</a></h2>
<p>Extracts include directories from input filesets and produces them as
a structured list. This is useful for passing include paths to compilation
tools.</p>
<section id="id17">
<h3>Example<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">package</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">incdirs.example</span>

<span class="w">    </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rtl_files</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">std.FileSet</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;*.sv&quot;</span>
<span class="w">        </span><span class="nt">incdirs</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">include</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rtl/include</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">extract_dirs</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">std.IncDirs</span>
<span class="w">      </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">rtl_files</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</section>
<section id="id18">
<h3>Consumes<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">std.FileSet</span></code> data items</p>
</section>
<section id="id19">
<h3>Produces<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h3>
<p>Produces a data item containing the collected include directories.</p>
</section>
<section id="id20">
<h3>Parameters<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h3>
<p>None. The task operates entirely on input filesets.</p>
</section>
</section>
<section id="std-message">
<h2>std.Message<a class="headerlink" href="#std-message" title="Link to this heading">¶</a></h2>
<p>Displays a message during task execution. Useful for logging, debugging,
and providing user feedback during flow execution.</p>
<section id="id21">
<h3>Example<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">package</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message.example</span>

<span class="w">    </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">std.Message</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Hello,</span><span class="nv"> </span><span class="s">World!&quot;</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">std.Message</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Build</span><span class="nv"> </span><span class="s">completed</span><span class="nv"> </span><span class="s">successfully&quot;</span>
<span class="w">      </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">build</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</section>
<section id="id22">
<h3>Consumes<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h3>
<p>All inputs by default (<code class="docutils literal notranslate"><span class="pre">consumes:</span> <span class="pre">all</span></code>)</p>
</section>
<section id="id23">
<h3>Produces<a class="headerlink" href="#id23" title="Link to this heading">¶</a></h3>
<p>Passes through all inputs. Does not produce additional data items.</p>
</section>
<section id="id24">
<h3>Parameters<a class="headerlink" href="#id24" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>msg</strong> - [Optional] The message to display (default: empty string)</p></li>
</ul>
<p>Messages support expression syntax for dynamic content:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">package</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example</span>
<span class="w">  </span><span class="nt">with</span><span class="p">:</span>
<span class="w">    </span><span class="nt">version</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span>

<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">version_msg</span>
<span class="w">    </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">std.Message</span>
<span class="w">    </span><span class="nt">with</span><span class="p">:</span>
<span class="w">      </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Building</span><span class="nv"> </span><span class="s">version</span><span class="nv"> </span><span class="s">${{</span><span class="nv"> </span><span class="s">version</span><span class="nv"> </span><span class="s">}}&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="std-prompt">
<h2>std.Prompt<a class="headerlink" href="#std-prompt" title="Link to this heading">¶</a></h2>
<p>Executes an AI assistant with a specified prompt and collects structured
results. The AI assistant must create a valid JSON result file or the task
will fail with an error.</p>
<p>This task enables AI-assisted workflows for code generation, documentation,
test creation, and other automated tasks that benefit from large language
model capabilities.</p>
<section id="id25">
<h3>Example<a class="headerlink" href="#id25" title="Link to this heading">¶</a></h3>
<p>Basic usage:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">package</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prompt.example</span>

<span class="w">    </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">generate_code</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">std.Prompt</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">user_prompt</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Generate</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">Python</span><span class="nv"> </span><span class="s">function</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">parse</span><span class="nv"> </span><span class="s">CSV</span><span class="nv"> </span><span class="s">files&quot;</span>
<span class="w">        </span><span class="nt">assistant</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">copilot</span>
</pre></div>
</div>
<p>Custom system prompt:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">package</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prompt.custom</span>

<span class="w">    </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">generate_test</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">std.Prompt</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">system_prompt</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">          </span><span class="no">You are a test generation assistant.</span>
<span class="w">          </span><span class="no">Input data: ${{ inputs }}</span>

<span class="w">          </span><span class="no">Generate unit tests for the code and write results to ${{ result_file }}</span>
<span class="w">          </span><span class="no">in JSON format with the following structure:</span>
<span class="w">          </span><span class="no">{</span>
<span class="w">            </span><span class="no">&quot;status&quot;: 0,</span>
<span class="w">            </span><span class="no">&quot;changed&quot;: true,</span>
<span class="w">            </span><span class="no">&quot;output&quot;: [],</span>
<span class="w">            </span><span class="no">&quot;markers&quot;: []</span>
<span class="w">          </span><span class="no">}</span>
<span class="w">        </span><span class="nt">user_prompt</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Create</span><span class="nv"> </span><span class="s">comprehensive</span><span class="nv"> </span><span class="s">unit</span><span class="nv"> </span><span class="s">tests&quot;</span>
<span class="w">        </span><span class="nt">result_file</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tests.result.json&quot;</span>
</pre></div>
</div>
</section>
<section id="id26">
<h3>Consumes<a class="headerlink" href="#id26" title="Link to this heading">¶</a></h3>
<p>All inputs by default (<code class="docutils literal notranslate"><span class="pre">consumes:</span> <span class="pre">all</span></code>). Input data is available in the
prompt via the <code class="docutils literal notranslate"><span class="pre">${{</span> <span class="pre">inputs</span> <span class="pre">}}</span></code> variable.</p>
</section>
<section id="id27">
<h3>Produces<a class="headerlink" href="#id27" title="Link to this heading">¶</a></h3>
<p>Outputs are determined by the AI assistant’s result JSON file. Typically
produces <code class="docutils literal notranslate"><span class="pre">std.FileSet</span></code> items for generated files, but can produce any
data type specified in the result.</p>
</section>
<section id="id28">
<h3>Parameters<a class="headerlink" href="#id28" title="Link to this heading">¶</a></h3>
<ul>
<li><p><strong>system_prompt</strong> - [Optional] System prompt template. Can include variable references:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">${{</span> <span class="pre">inputs</span> <span class="pre">}}</span></code> - JSON of input data from upstream tasks</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${{</span> <span class="pre">name</span> <span class="pre">}}</span></code> - Current task name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${{</span> <span class="pre">result_file</span> <span class="pre">}}</span></code> - Expected result filename</p></li>
</ul>
<p>If empty, uses a default template that describes the expected JSON result format.</p>
</li>
<li><p><strong>user_prompt</strong> - [Optional] User’s prompt content. This is appended to the
system prompt with a “User Request:” header.</p></li>
<li><p><strong>result_file</strong> - [Optional] Name of the JSON result file the AI must create
(default: <code class="docutils literal notranslate"><span class="pre">{name}.result.json</span></code>). The task fails if this file is missing or
contains invalid JSON.</p></li>
<li><p><strong>assistant</strong> - [Optional] AI assistant to use. Options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">copilot</span></code> - GitHub Copilot CLI (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">openai</span></code> - OpenAI API (not yet implemented)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">claude</span></code> - Claude API (not yet implemented)</p></li>
</ul>
</li>
<li><p><strong>assistant_config</strong> - [Optional] Map of assistant-specific configuration
(e.g., API keys, model settings)</p></li>
</ul>
</section>
<section id="required-result-format">
<h3>Required Result Format<a class="headerlink" href="#required-result-format" title="Link to this heading">¶</a></h3>
<p>The AI assistant must create a JSON file with the following structure:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;changed&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;output&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;std.FileSet&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;filetype&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pythonSource&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;basedir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;files&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;generated.py&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;markers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;msg&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Generated 1 file&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;severity&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;info&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Fields:</p>
<ul class="simple">
<li><p><strong>status</strong> - Exit code (0 = success, non-zero = failure)</p></li>
<li><p><strong>changed</strong> - Whether the task produced new/modified outputs</p></li>
<li><p><strong>output</strong> - Array of output data items (e.g., FileSets)</p></li>
<li><p><strong>markers</strong> - Array of diagnostic messages with severity levels</p></li>
</ul>
</section>
<section id="error-handling">
<h3>Error Handling<a class="headerlink" href="#error-handling" title="Link to this heading">¶</a></h3>
<p>The Prompt task uses strict validation:</p>
<ul class="simple">
<li><p><strong>Missing result file</strong> → Task fails with status=1</p></li>
<li><p><strong>Invalid JSON syntax</strong> → Task fails with status=1</p></li>
<li><p><strong>Result is not a JSON object</strong> → Task fails with status=1</p></li>
<li><p><strong>Assistant not available</strong> → Task fails with status=1</p></li>
<li><p><strong>Assistant execution fails</strong> → Task fails with assistant’s exit code</p></li>
</ul>
</section>
<section id="debugging">
<h3>Debugging<a class="headerlink" href="#debugging" title="Link to this heading">¶</a></h3>
<p>When the Prompt task runs, it creates several files in the task’s run directory:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{name}.prompt.txt</span></code> - The complete prompt sent to the AI assistant</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{name}.result.json</span></code> - The structured result from the AI (if created)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assistant.stdout.log</span></code> - Standard output from the AI assistant</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assistant.stderr.log</span></code> - Standard error from the AI assistant</p></li>
</ul>
<p>These files are invaluable for debugging when the AI assistant doesn’t produce
the expected result or when result parsing fails.</p>
</section>
<section id="setup-requirements">
<h3>Setup Requirements<a class="headerlink" href="#setup-requirements" title="Link to this heading">¶</a></h3>
<p><strong>GitHub Copilot CLI</strong></p>
<p>To use the default <code class="docutils literal notranslate"><span class="pre">copilot</span></code> assistant:</p>
<ol class="arabic">
<li><p>Install GitHub CLI: <a class="reference external" href="https://cli.github.com/">https://cli.github.com/</a></p></li>
<li><p>Install Copilot extension:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gh<span class="w"> </span>extension<span class="w"> </span>install<span class="w"> </span>github/gh-copilot
</pre></div>
</div>
</li>
<li><p>Authenticate:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gh<span class="w"> </span>auth<span class="w"> </span>login
</pre></div>
</div>
</li>
</ol>
<p><strong>Other Assistants</strong></p>
<p>OpenAI and Claude assistants are placeholders for future implementation.
Contributions are welcome!</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">DV Flow Manager</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../incremental.html">Incremental Builds</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="fundamentals.html">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="packages.html">Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks_using.html">Using Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="visibility.html">Task Visibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks_developing.html">Developing Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Parameters and Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="expressions.html">Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_features.html">Advanced Features</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Standard Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="llm_integration.html">LLM Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#dataflow">Dataflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Flow-Spec Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/types_api.html">Type System API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cmdref.html">Command reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llms.html">LLM Agent Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pytask_api.html">Python Task API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task_runners.html">Task Runners</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">User Guide</a><ul>
      <li>Previous: <a href="advanced_features.html" title="previous chapter">Advanced Features</a></li>
      <li>Next: <a href="llm_integration.html" title="next chapter">LLM Integration</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2023-2025, Matthew Ballance.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/userguide/stdlib.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>